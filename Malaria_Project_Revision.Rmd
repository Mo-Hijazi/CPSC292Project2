---
title: "TEST PROJECT"
author: "Mo Hijazi"
date: "10/16/2021"
output: html_document
---
---
title: "Project 1 - Malaria"
author: "Mo Hijazi"
date: "10/12/2021"
output: html_document
---
```{r}
# All libraries required for code.
library(ggplot2)
library(reshape2)
library(tidyr)
library(janitor)
library(packcircles)
library(viridis)
library(viridisLite)
library(maps)
library(tidyverse)
library(scales)
library(gganimate)
library(gifski)
library(dplyr)
library(gapminder)
library(ggthemes)
library(readr)
library(magick)
library(magrittr)
```

Loading in the data set "malaria_data.csv." The data set contains malaria related deaths in different countries in relation to age. 
```{r, include=T}
knitr::opts_chunk$set(echo = TRUE)

#Loading in the csv file. 
malaria <- read.csv("malaria_data_2.csv", skip = 1)
```

Cleaning up the data set: 
```{r, include=T}
#Renaming specific countries on the data to match the world map names.
malaria$Entity[1401:1428] <- "Ivory Coast"
malaria$Entity[1345:1372] <- "Democratic Republic of the Congo"
malaria$Entity[1541:1568] <- "Democratic Republic of the Congo"
malaria$Entity[1065:1092] <- "China"
malaria$Entity[1121:1148] <- "Spain"
malaria$Entity[1681:1708] <- "China"
malaria$Entity[5209:5236] <- "China"
malaria$Entity[5293:5348] <- "China"

#Making sure the data is numeric for calculations.
malaria$Entity <- factor(malaria$Entity) 
#Cleaning up the column names, removing unneeded columns, and omitting any NA values.
malaria <- clean_names(malaria)
malaria <- subset(malaria, select = -2) %>% 
  na.omit(malaria)

for(i in 1990:2017){
  #assign(paste0("malaria",i),malaria[malaria$year==i,])
  clean.malaria <- malaria[malaria$year==i,]
  rownames(clean.malaria) <- seq(length=nrow(clean.malaria))
  malaria.all <- rowSums(clean.malaria[1:230,3:7])
  assign(paste0("malaria",i), clean.malaria)
}
```

Creating a data frame with all age groups combined:
```{r, include=T}
#combining all column of death by age into 1 column.
for(i in 1990:2017) 
 paste0("malaria.all.",i) rowSums(paste0("malaria",i,"[1:230,3:7]"))   

malaria.all.1990 <- rowSums(malaria1990[1:230,3:7])
malaria.all.1991 <- rowSums(malaria1991[1:230,3:7])
malaria.all.1992 <- rowSums(malaria1992[1:230,3:7])
malaria.all.1993 <- rowSums(malaria1993[1:230,3:7])
malaria.all.1994 <- rowSums(malaria1994[1:230,3:7])
malaria.all.1995 <- rowSums(malaria1995[1:230,3:7])
malaria.all.1996 <- rowSums(malaria1996[1:230,3:7])
malaria.all.1997 <- rowSums(malaria1997[1:230,3:7])
malaria.all.1998 <- rowSums(malaria1998[1:230,3:7])
malaria.all.1999 <- rowSums(malaria1999[1:230,3:7])
malaria.all.2000 <- rowSums(malaria2001[1:230,3:7])
malaria.all.2001 <- rowSums(malaria2001[1:230,3:7])
malaria.all.2002 <- rowSums(malaria2002[1:230,3:7])
malaria.all.2003 <- rowSums(malaria2003[1:230,3:7])
malaria.all.2004 <- rowSums(malaria2004[1:230,3:7])
malaria.all.2005 <- rowSums(malaria2005[1:230,3:7])
malaria.all.2006 <- rowSums(malaria2006[1:230,3:7])
malaria.all.2007 <- rowSums(malaria2007[1:230,3:7])
malaria.all.2008 <- rowSums(malaria2008[1:230,3:7])
malaria.all.2009 <- rowSums(malaria2009[1:230,3:7])
malaria.all.2010 <- rowSums(malaria2010[1:230,3:7])
malaria.all.2011 <- rowSums(malaria2011[1:230,3:7])
malaria.all.2012 <- rowSums(malaria2012[1:230,3:7])
malaria.all.2013 <- rowSums(malaria2013[1:230,3:7])
malaria.all.2014 <- rowSums(malaria2014[1:230,3:7])
malaria.all.2015 <- rowSums(malaria2015[1:230,3:7])
malaria.all.2016 <- rowSums(malaria2016[1:230,3:7])
malaria.all.2017 <- rowSums(malaria2017[1:230,3:7])
malaria.all <- rowSums(malaria[1:6440,2:5])

#creating data frame with the country names and binding it with the death sums.
malaria.country <- data.frame(malaria[,1])
malaria.all <- cbind(malaria.country,malaria.all)
malaria.all.1990 <- cbind(malaria.country,malaria.all.1990)
malaria.all.1991 <- cbind(malaria.country,malaria.all.1991)
malaria.all.1992 <- cbind(malaria.country,malaria.all.1992)
malaria.all.1993 <- cbind(malaria.country,malaria.all.1993)
malaria.all.1994 <- cbind(malaria.country,malaria.all.1994)
malaria.all.1995 <- cbind(malaria.country,malaria.all.1995)
malaria.all.1996 <- cbind(malaria.country,malaria.all.1996)
malaria.all.1997 <- cbind(malaria.country,malaria.all.1997)
malaria.all.1998 <- cbind(malaria.country,malaria.all.1998)
malaria.all.1999 <- cbind(malaria.country,malaria.all.1999)
malaria.all.2000<- cbind(malaria.country,malaria.all.2000)
malaria.all.2001<- cbind(malaria.country,malaria.all.2001)
malaria.all.2002<- cbind(malaria.country,malaria.all.2002)
malaria.all.2003<- cbind(malaria.country,malaria.all.2003)
malaria.all.2004<- cbind(malaria.country,malaria.all.2004)
malaria.all.2005<- cbind(malaria.country,malaria.all.2005)
malaria.all.2006<- cbind(malaria.country,malaria.all.2006)
malaria.all.2007<- cbind(malaria.country,malaria.all.2007)
malaria.all.2008<- cbind(malaria.country,malaria.all.2008)
malaria.all.2009<- cbind(malaria.country,malaria.all.2009)
malaria.all.2010<- cbind(malaria.country,malaria.all.2010)
malaria.all.2011<- cbind(malaria.country,malaria.all.2011)
malaria.all.2012<- cbind(malaria.country,malaria.all.2012)
malaria.all.2013<- cbind(malaria.country,malaria.all.2013)
malaria.all.2014<- cbind(malaria.country,malaria.all.2014)
malaria.all.2015<- cbind(malaria.country,malaria.all.2015)
malaria.all.2016<- cbind(malaria.country,malaria.all.2016)
malaria.all.2017<- cbind(malaria.country,malaria.all.2017)

#Renaming column names.
column.names <- function(dataframename){
  names(dataframename)[2] <- "death"
  names(dataframename)[1] <- "region"
}

column.names("malaria.all.1990")



names(malaria.all.1990)[2] <- "deaths"
names(malaria.all.1990)[1] <- "region"

names(malaria.all.1991)[2] <- "deaths"
names(malaria.all.1991)[1] <- "region"

names(malaria.all.1992)[2] <- "deaths"
names(malaria.all.1992)[1] <- "region"

names(malaria.all.1993)[2] <- "deaths"
names(malaria.all.1993)[1] <- "region"

names(malaria.all.1994)[2] <- "deaths"
names(malaria.all.1994)[1] <- "region"

names(malaria.all.1995)[2] <- "deaths"
names(malaria.all.1995)[1] <- "region"

names(malaria.all.1996)[2] <- "deaths"
names(malaria.all.1996)[1] <- "region"

names(malaria.all.1997)[2] <- "deaths"
names(malaria.all.1997)[1] <- "region"

names(malaria.all.1998)[2] <- "deaths"
names(malaria.all.1998)[1] <- "region"

names(malaria.all.1999)[2] <- "deaths"
names(malaria.all.1999)[1] <- "region"

names(malaria.all.2000)[2] <- "deaths"
names(malaria.all.2000)[1] <- "region"

names(malaria.all.2001)[2] <- "deaths"
names(malaria.all.2001)[1] <- "region"

names(malaria.all.2002)[2] <- "deaths"
names(malaria.all.2002)[1] <- "region"

names(malaria.all.2003)[2] <- "deaths"
names(malaria.all.2003)[1] <- "region"

names(malaria.all.2004)[2] <- "deaths"
names(malaria.all.2004)[1] <- "region"

names(malaria.all.2005)[2] <- "deaths"
names(malaria.all.2005)[1] <- "region"

names(malaria.all.2006)[2] <- "deaths"
names(malaria.all.2006)[1] <- "region"

names(malaria.all.2007)[2] <- "deaths"
names(malaria.all.2007)[1] <- "region"

names(malaria.all.2008)[2] <- "deaths"
names(malaria.all.2008)[1] <- "region"

names(malaria.all.2009)[2] <- "deaths"
names(malaria.all.2009)[1] <- "region"

names(malaria.all.2010)[2] <- "deaths"
names(malaria.all.2010)[1] <- "region"

names(malaria.all.2011)[2] <- "deaths"
names(malaria.all.2011)[1] <- "region"

names(malaria.all.2012)[2] <- "deaths"
names(malaria.all.2012)[1] <- "region"

names(malaria.all.2013)[2] <- "deaths"
names(malaria.all.2013)[1] <- "region"

names(malaria.all.2014)[2] <- "deaths"
names(malaria.all.2014)[1] <- "region"

names(malaria.all.2015)[2] <- "deaths"
names(malaria.all.2015)[1] <- "region"

names(malaria.all.2016)[2] <- "deaths"
names(malaria.all.2016)[1] <- "region"

names(malaria.all.2017)[2] <- "deaths"
names(malaria.all.2017)[1] <- "region"

names(malaria.all)[2] <- "deaths"
names(malaria.all)[1] <- "region"

```

Combining world map data with my data to create visual:
```{r echo=FALSE}
#Leading in map data (lat and long values).
mapdata <- map_data("world")

#Combining my data with map values.
mapdata1 <- malaria.all %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)
#Removing unneeded column
mapdata1 <- subset(mapdata1, select = -7)
mapdata1$deaths <- log(mapdata1$deaths)
#creating a map that will have different shades of colors depending on the # of deaths per country. 
wtihout_canvas = ggplot(mapdata1, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ # This line is important because we don't have data for every country to it the "na.rm" still allows for those countries to appear on the map. 
  #Low death counts are green and high death rates as red.
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (1990-2017)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-3.png",height = 6, width=9)
```

```{r echo=FALSE}
#Leading in map data (lat and long values).
mapdata <- map_data("world")

#Combining my data with map values.
mapdata1990 <- malaria.all.1990 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)
#Removing unneeded column
mapdata1990 <- subset(mapdata1990, select = -7)
mapdata1990$deaths <- log(mapdata1990$deaths)
#creating a map that will have different shades of colors depending on the # of deaths per country. 
wtihout_canvas = ggplot(mapdata1990, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ # This line is important because we don't have data for every country to it the "na.rm" still allows for those countries to appear on the map. 
  #Low death counts are green and high death rates as red.
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1990)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1990.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1991 <- malaria.all.1991 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1991 <- subset(mapdata1991, select = -7)
mapdata1991$deaths <- log(mapdata1991$deaths)

wtihout_canvas = ggplot(mapdata1991, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1991)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1991.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1992 <- malaria.all.1992 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1992 <- subset(mapdata1992, select = -7)
mapdata1992$deaths <- log(mapdata1992$deaths)

wtihout_canvas = ggplot(mapdata1992, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1992)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1992.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1993 <- malaria.all.1993 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1993 <- subset(mapdata1993, select = -7)
mapdata1993$deaths <- log(mapdata1993$deaths)

wtihout_canvas = ggplot(mapdata1993, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1993)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1993.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1994 <- malaria.all.1994 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1994 <- subset(mapdata1994, select = -7)
mapdata1994$deaths <- log(mapdata1994$deaths)

wtihout_canvas = ggplot(mapdata1994, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1994)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1994.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1995 <- malaria.all.1995 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1995 <- subset(mapdata1995, select = -7)
mapdata1995$deaths <- log(mapdata1995$deaths)

wtihout_canvas = ggplot(mapdata1995, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1995)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1995.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1996 <- malaria.all.1996 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1996 <- subset(mapdata1996, select = -7)
mapdata1996$deaths <- log(mapdata1996$deaths)

wtihout_canvas = ggplot(mapdata1996, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1996)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1996.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1997 <- malaria.all.1997 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1997 <- subset(mapdata1997, select = -7)
mapdata1997$deaths <- log(mapdata1997$deaths)

wtihout_canvas = ggplot(mapdata1997, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1997)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1997.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1998 <- malaria.all.1998 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1998 <- subset(mapdata1998, select = -7)
mapdata1998$deaths <- log(mapdata1998$deaths)

wtihout_canvas = ggplot(mapdata1998, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1998)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1998.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata1999 <- malaria.all.1999 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata1999 <- subset(mapdata1999, select = -7)
mapdata1999$deaths <- log(mapdata1999$deaths)

wtihout_canvas = ggplot(mapdata1999, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 1999)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-1999.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2000 <- malaria.all.2000 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2000 <- subset(mapdata2000, select = -7)
mapdata2000$deaths <- log(mapdata2000$deaths)

wtihout_canvas = ggplot(mapdata2000, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2000)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2000.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2001 <- malaria.all.2001 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2001 <- subset(mapdata2001, select = -7)
mapdata2001$deaths <- log(mapdata2001$deaths)

wtihout_canvas = ggplot(mapdata2001, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2001)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2001.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2002 <- malaria.all.2002 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2002 <- subset(mapdata2002, select = -7)
mapdata2002$deaths <- log(mapdata2002$deaths)

wtihout_canvas = ggplot(mapdata2002, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2002)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2002.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2003 <- malaria.all.2003 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2003 <- subset(mapdata2003, select = -7)
mapdata2003$deaths <- log(mapdata2003$deaths)

wtihout_canvas = ggplot(mapdata2003, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2003)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2003.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2004 <- malaria.all.2004 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2004 <- subset(mapdata2004, select = -7)
mapdata2004$deaths <- log(mapdata2004$deaths)

wtihout_canvas = ggplot(mapdata2004, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2004)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2004.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2005 <- malaria.all.2005 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2005 <- subset(mapdata2005, select = -7)
mapdata2005$deaths <- log(mapdata2005$deaths)

wtihout_canvas = ggplot(mapdata2005, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2005)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2005.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2006 <- malaria.all.2006 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2006 <- subset(mapdata2006, select = -7)
mapdata2006$deaths <- log(mapdata2006$deaths)

wtihout_canvas = ggplot(mapdata2006, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2006)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2006.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2007 <- malaria.all.2007 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2007 <- subset(mapdata2007, select = -7)
mapdata2007$deaths <- log(mapdata2007$deaths)

wtihout_canvas = ggplot(mapdata2007, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2007)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2007.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2008 <- malaria.all.2008 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2008 <- subset(mapdata2008, select = -7)
mapdata2008$deaths <- log(mapdata2008$deaths)

wtihout_canvas = ggplot(mapdata2008, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2008)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2008.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2009 <- malaria.all.2009 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2009 <- subset(mapdata2009, select = -7)
mapdata2009$deaths <- log(mapdata2009$deaths)

wtihout_canvas = ggplot(mapdata2009, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2009)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2009.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2010 <- malaria.all.2010 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2010 <- subset(mapdata2010, select = -7)
mapdata2010$deaths <- log(mapdata2010$deaths)

wtihout_canvas = ggplot(mapdata2010, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2010)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2010.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2011 <- malaria.all.2011 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2011 <- subset(mapdata2011, select = -7)
mapdata2011$deaths <- log(mapdata2011$deaths)

wtihout_canvas = ggplot(mapdata2011, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2011)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2011.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2012 <- malaria.all.2012 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2012 <- subset(mapdata2012, select = -7)
mapdata2012$deaths <- log(mapdata2012$deaths)

wtihout_canvas = ggplot(mapdata2012, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2012)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2012.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2013 <- malaria.all.2013 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2013 <- subset(mapdata2013, select = -7)
mapdata2013$deaths <- log(mapdata2013$deaths)

wtihout_canvas = ggplot(mapdata2013, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2013)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2013.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2014 <- malaria.all.2014 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2014 <- subset(mapdata2014, select = -7)
mapdata2014$deaths <- log(mapdata2014$deaths)

wtihout_canvas = ggplot(mapdata2014, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2014)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2014.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2015 <- malaria.all.2015 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2015 <- subset(mapdata2015, select = -7)
mapdata2015$deaths <- log(mapdata2015$deaths)

wtihout_canvas = ggplot(mapdata2015, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2015)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2015.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2016 <- malaria.all.2016 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2016 <- subset(mapdata2016, select = -7)
mapdata2016$deaths <- log(mapdata2016$deaths)

wtihout_canvas = ggplot(mapdata2016, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2016)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2016.png",height = 6, width=9)
```

```{r}
mapdata <- map_data("world")

mapdata2017 <- malaria.all.2017 %>%
  right_join(mapdata, by= "region") %>%
  group_by(region)

mapdata2017 <- subset(mapdata2017, select = -7)
mapdata2017$deaths <- log(mapdata2017$deaths)

wtihout_canvas = ggplot(mapdata2017, aes(long, lat, group=group))+
  geom_polygon(aes(fill=deaths), na.rm="black")+ 
  scale_fill_gradient(name = "Number of Deaths", low = "green", high = "red", breaks = c(2,10), labels=c("Low death rates", "High death rates"), limits = c(0,12))+
  labs(title = "Average Number of Malaria Related Deaths in Different Countries (Year: 2017)",
       caption = "** Gray regions do not have malaria deaths or data pretaining to number of malaria deaths **")+
  theme_void()
ggsave("Mo-NewPlot-2017.png",height = 6, width=9)
```

```{r}
list.files(pattern = '*.png', full.names = TRUE) %>% 
        image_read() %>% # reads each path file
        image_join() %>% # joins image
        image_animate(fps=1) %>% # animates, can opt for number of loops
        image_write("Mo-AnimatedMap.gif") # write to current dir
```
***UPDATES FOR VISUAL 1***
Hannah Sukhdeo, Sarah Fraschetti, Azure Gilmore: I log-ed all death values making the range of deaths much more compact. This created a better representation with the color gradient I used. 

I used the "without_canvas" function to reduce amount of computing needed when creating the map. This reduced the time from ~25 minutes to ~15 seconds! YAY!

I added a title and a caption describing the gray regions of the map. 

I animated the map by year! (For this I had to save the maps for each year as a PNG which took forever. I noticed saving to PDF took way less time; however, I couldn't get R to convert from PDF to PNG.)

VISUAL 2:
```{r, include=T}
#Loading in the csv file. 
Visual2malaria <- read.csv("malaria_data.csv", skip = 1)
#creating a data frame with just "world" death counts
Visual2malaria <- data.frame(Visual2malaria[6357:6384,]) 
#Removing unneeded columns
Visual2malaria <- subset(Visual2malaria, select = -2)
Visual2malaria <- subset(Visual2malaria, select = -1)
#making year counts as characters for easier visual edits. 
Visual2malaria$Year <- as.character(Visual2malaria$Year)
#Combining column deaths. 
total.deaths <- rowSums(Visual2malaria[,2:6])
year <- Visual2malaria$Year
#Creating a new data fram with years and total deaths.
malaria.world <- cbind(year, total.deaths)
malaria.world <- as.data.frame(malaria.world)

```


```{r, include=T}
#Making all death counts into numeric values.
malaria.world$total.deaths <- as.numeric(malaria.world$total.deaths)
#Creating bar graph and making aes edits to bar graph.
ggplot(malaria.world, aes(x= year, y= total.deaths, fill = year))+
  theme_dark()+
  geom_bar(stat = "identity")+ 
  theme(text = element_text(size=10),
        axis.text.x = element_text(angle=90, hjust=1))+
  scale_y_continuous(name="Total Deaths", breaks= seq(0,1500000, by= 100000), labels = comma, expand = c(0, 0))+
  xlab("Year")+
  ggtitle("Total Malaria Deaths per Year")+
  theme(legend.position = "none")+ 
  theme(plot.title = element_text(hjust = 0.5))
```
***UPDATE***
Hannah Sukhdeo: You mentioned to add percentages to each of the brag graph I don't think this would be proper for this visual as each graph is a total number of deaths for each year.


------------------------------------------------------------------------------------------------------------------------
***Resources***
https://stackoverflow.com/questions/61838700/query-on-how-to-make-world-heat-map-using-ggplot-in-r
https://stackoverflow.com/questions/42683522/r-how-to-sum-a-variable-by-certain-levels-contained-in-a-list-of-another-varia
https://www.youtube.com/watch?v=AgWgPSZ7Gp0
https://stackoverflow.com/questions/13353213/gradient-of-n-colors-ranging-from-color-1-and-color-2
https://stackoverflow.com/questions/60268389/china-not-showing-on-chloropleth-map-in-r
https://www.youtube.com/watch?v=AgWgPSZ7Gp0
https://www.datanovia.com/en/blog/how-to-remove-legend-from-a-ggplot/
https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization
https://www.r-graph-gallery.com/218-basic-barplots-with-ggplot2.html
https://stackoverflow.com/questions/1330989/rotating-and-spacing-axis-labels-in-ggplot2
https://www.datanovia.com/en/blog/how-to-set-ggplot-breaks/
http://www.sthda.com/english/wiki/ggplot2-axis-ticks-a-guide-to-customize-tick-marks-and-labels
https://stackoverflow.com/questions/40675778/center-plot-title-in-ggplot2
https://statisticsglobe.com/change-formatting-of-numbers-of-ggplot2-plot-axis-in-r
https://stackoverflow.com/questions/13701347/force-the-origin-to-start-at-0
https://www.datasciencemadesimple.com/delete-or-drop-rows-in-r-with-conditions-2/
https://stackoverflow.com/questions/56389470/convert-multiple-png-to-gif-as-an-animation-in-r



